FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt requirements.txt

RUN pip install -r requirements.txt

RUN python -m nltk.downloader punkt

COPY . .

ARG EMAIL_SENDER
ENV EMAIL_SENDER=${EMAIL_SENDER}

ARG VITE_GOOGLE_ID
ENV VITE_GOOGLE_ID=${VITE_GOOGLE_ID}

ARG DTB_URL
ENV DTB_URL=${DTB_URL}

ARG DTB_KEY
ENV DTB_KEY=${DTB_KEY}

ARG STRIPE_SECRET_KEY
ENV STRIPE_SECRET_KEY=${STRIPE_SECRET_KEY}

ARG STRIPE_PUBLISHABLE_KEY
ENV STRIPE_PUBLISHABLE_KEY=${STRIPE_PUBLISHABLE_KEY}

ARG STRIPE_ENDPOINT_SECRET
ENV STRIPE_ENDPOINT_SECRET=${STRIPE_ENDPOINT_SECRET}

ARG API_URL
ENV API_URL=${API_URL}

ARG BEARER_KEY
ENV BEARER_KEY=${BEARER_KEY}

EXPOSE 5000

CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "app:app"]